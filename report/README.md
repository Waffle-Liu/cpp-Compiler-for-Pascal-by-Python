# Report 编译原理项目报告

# CPP: Compile for Pascal by Python 

| 邱兆林 | 刘洪甫 | 任宇凡     |
| ------ | ------ | ---------- |
|        |        | 3160104704 |

## 总体架构

![image-20190613194718564](assets/image-20190613194718564.png)

如上图所示，在CPP(Compiler for Pascal in Python)中，我们实现了从pascal代码到最终可执行的MIPS代码之间的编译过程。最终获得的MIPS代码可以在Mips模拟器上直接运行并且获得Pascal代码想要的结果。

在处理的过程中首先是通过词法和语法分析，从pascal代码构建抽象语法树，在这个过程中也完成了符号表的构建和中间代码的生成。在中间代码的生成过程中进行了类型检查。当完成了中间代码的生成和符号表的构建之后开始目标代码的生成。

和一般使用的通过LLVM的方式实现中间代码的生成到目标代码的生成的方法不同，在我们的工程中我们自己实现了中间代码的生成到目标代码的生成工作。这也就意味着我们需要自己维护运行时环境，这包括了跳转到函数过程中访问链和控制链的维护，也包括了栈内存的分配，返回地址的保护，也包括从函数返回过程中，恢复现场(恢复寄存器)，和保存返回值的工作。

最终我们将生成的MIPS代码放在MIPS模拟器上直接运行，然后得到了正确的结果。

在本报告的倒数第二个章节，我们对老师提供的测试样例，以及我们自己编写的一些测试样例进行了测试，均得到了正确的结果。我们还会对这样的结果进行分析。在最后一个章节我们会对我们的编译器提出可能的优化与展望。

## 词法分析

词法分析部分部分的主要功能是将输入分析的pascal文本处理成一个一个的token。这是编译器处理的第一个环节

### ply.lex


## 语法分析



### ply.yacc



## 语义分析



## 符号表

![image-20190613195223079](assets/image-20190613195223079.png)



## 中间代码生成



## 代码生成

![image-20190613195205142](assets/image-20190613195205142.png)

## 测试样例





## 优化与展望





## 附1： 分工



## 附2：测试样例与工程代码